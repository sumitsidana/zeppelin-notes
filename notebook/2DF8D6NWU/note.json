{
  "paragraphs": [
    {
      "text": "val parquetFileOfferTemp \u003d sqlContext.read.parquet(\"/data/sidana/purch_april_2018/*.parquet\")\nval uniqueUsers \u003d parquetFileOfferTemp.select($\"userId\").distinct.count\nval offerId \u003d parquetFileOfferTemp.select(\"offerId\").distinct.count\nval clickCount \u003d parquetFileOfferTemp.filter($\"wasClicked\").distinct.count\nval uniqueOfferViews \u003d parquetFileOfferTemp.select(\"offerViewId\").distinct.count\nval offers \u003d parquetFileOfferTemp.select($\"offerId\",$\"userId\")\nval clicks  \u003d parquetFileOfferTemp.select($\"wasClicked\",$\"userId\")\nval groupedClicks \u003d clicks.filter($\"wasClicked\").groupBy($\"userId\").count.sort(desc(\"count\"))\nval groupedOffers \u003d offers.groupBy($\"userId\").count.sort(desc(\"count\"))\nval offerAvg \u003d groupedOffers.select(avg($\"count\"))\nofferAvg.show\nval clickAvg \u003d groupedClicks.select(avg($\"count\"))\nclickAvg.show",
      "authenticationInfo": {},
      "dateUpdated": "Jun 8, 2018 11:44:07 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1528447750999_-756910363",
      "id": "20180608-104910_1180517055",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "parquetFileOfferTemp: org.apache.spark.sql.DataFrame \u003d [source: string, offerId: string, pageViewId: string, offerViewId: string, utcDate: timestamp, keywords: array\u003cstring\u003e, wasClicked: boolean, offerViewCountPerPageView: bigint, clickCountPerPageView: bigint, userId: double, productLemmas: array\u003cstring\u003e, productFeatures: vector, url: string, pageLemmas: array\u003cstring\u003e, pageFeatures: vector]\nuniqueUsers: Long \u003d 5894431\nofferId: Long \u003d 14716\nclickCount: Long \u003d 337511\nuniqueOfferViews: Long \u003d 48754927\noffers: org.apache.spark.sql.DataFrame \u003d [offerId: string, userId: double]\nclicks: org.apache.spark.sql.DataFrame \u003d [wasClicked: boolean, userId: double]\ngroupedClicks: org.apache.spark.sql.DataFrame \u003d [userId: double, count: bigint]\ngroupedOffers: org.apache.spark.sql.DataFrame \u003d [userId: double, count: bigint]\nofferAvg: org.apache.spark.sql.DataFrame \u003d [avg(count): double]\n+-----------------+\n|       avg(count)|\n+-----------------+\n|8.271354266425377|\n+-----------------+\n\nclickAvg: org.apache.spark.sql.DataFrame \u003d [avg(count): double]\n+-----------------+\n|       avg(count)|\n+-----------------+\n|1.350616661464461|\n+-----------------+\n\n"
      },
      "dateCreated": "Jun 8, 2018 10:49:10 AM",
      "dateStarted": "Jun 8, 2018 11:44:07 AM",
      "dateFinished": "Jun 8, 2018 1:27:58 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val parquetFileOfferTemp \u003d sqlContext.read.parquet(\"/data/sidana/purch_april_2018/*.parquet\")\nval clicks \u003d parquetFileOfferTemp.filter(\"wasClicked\")\nval groupByDate \u003d clicks.groupBy(to_date(parquetFileOfferTemp(\"utcDate\"))).count\nz.show(groupByDate)",
      "authenticationInfo": {},
      "dateUpdated": "Jun 8, 2018 1:37:37 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1528447927375_2145694992",
      "id": "20180608-105207_1604847258",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "todate(utcDate)\tcount\n2018-04-10\t9937\n2018-04-11\t10765\n2018-04-12\t10191\n2018-04-13\t9852\n2018-04-14\t9579\n2018-04-15\t11583\n2018-04-16\t12034\n2018-04-17\t12449\n2018-04-18\t12563\n2018-04-19\t12735\n2018-04-20\t11838\n2018-04-21\t10966\n2018-04-22\t12256\n2018-04-23\t13059\n2018-04-24\t12465\n2018-04-25\t11173\n2018-04-26\t11923\n2018-04-27\t11161\n2018-04-28\t11273\n2018-04-29\t12215\n2018-04-30\t12977\n2018-05-01\t1246\n2018-04-01\t8494\n2018-04-02\t10448\n2018-04-03\t10553\n2018-04-04\t10970\n2018-04-05\t9264\n2018-04-06\t10410\n2018-04-07\t10416\n2018-04-08\t11058\n2018-04-09\t11658\n"
      },
      "dateCreated": "Jun 8, 2018 10:52:07 AM",
      "dateStarted": "Jun 8, 2018 1:37:37 PM",
      "dateFinished": "Jun 8, 2018 1:59:18 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val parquetFileOfferTemp \u003d sqlContext.read.parquet(\"/data/sidana/purch_april_2018/*.parquet\")\nval clicks \u003d parquetFileOfferTemp.filter(\"wasClicked\")\nval groupByWeek \u003d clicks.groupBy(weekofyear(clicks(\"utcDate\"))).count\nz.show(groupByWeek)",
      "authenticationInfo": {},
      "dateUpdated": "Jun 8, 2018 6:36:46 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1528475766594_596799301",
      "id": "20180608-183606_48256098",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "weekofyear(utcDate)\tcount\n13\t8494\n14\t73119\n15\t73565\n16\t84841\n17\t83269\n18\t14223\n"
      },
      "dateCreated": "Jun 8, 2018 6:36:06 PM",
      "dateStarted": "Jun 8, 2018 6:36:46 PM",
      "dateFinished": "Jun 8, 2018 6:56:58 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val groupByDate \u003d parquetFileOfferTemp.groupBy(to_date(parquetFileOfferTemp(\"utcDate\"))).count\nz.show(groupByDate)",
      "authenticationInfo": {},
      "dateUpdated": "Jun 8, 2018 1:37:49 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1528457825044_2054762012",
      "id": "20180608-133705_523440698",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "todate(utcDate)\tcount\n2018-04-10\t1636725\n2018-04-11\t1611433\n2018-04-12\t1450672\n2018-04-13\t1389468\n2018-04-14\t1269500\n2018-04-15\t1556250\n2018-04-16\t1587980\n2018-04-17\t1730063\n2018-04-18\t1737257\n2018-04-19\t1928639\n2018-04-20\t1769167\n2018-04-21\t1608053\n2018-04-22\t1748687\n2018-04-23\t1859189\n2018-04-24\t1728110\n2018-04-25\t1610742\n2018-04-26\t1585133\n2018-04-27\t1590974\n2018-04-28\t1610538\n2018-04-29\t1661853\n2018-04-30\t1694451\n2018-05-01\t152263\n2018-04-01\t1401171\n2018-04-02\t1620364\n2018-04-03\t1590722\n2018-04-04\t1599708\n2018-04-05\t1424072\n2018-04-06\t1541178\n2018-04-07\t1661033\n2018-04-08\t1701129\n2018-04-09\t1698403\n"
      },
      "dateCreated": "Jun 8, 2018 1:37:05 PM",
      "dateStarted": "Jun 8, 2018 1:37:49 PM",
      "dateFinished": "Jun 8, 2018 2:20:38 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val clicks  \u003d parquetFileOfferTemp.select($\"wasClicked\",$\"userId\")\nval groupedClicks \u003d clicks.filter($\"wasClicked\").groupBy($\"userId\").count.sort(desc(\"count\"))\nz.show(groupedClicks)",
      "authenticationInfo": {},
      "dateUpdated": "Jun 8, 2018 4:45:59 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1528457900429_-1060109244",
      "id": "20180608-133820_714847379",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "userId\tcount\n4561278.0\t119\n1791221.0\t100\n4255122.0\t82\n5055669.0\t82\n5782907.0\t74\n5264033.0\t71\n5287922.0\t61\n4507433.0\t55\n3778865.0\t55\n2094255.0\t53\n1388871.0\t49\n1600410.0\t49\n4601914.0\t44\n4113233.0\t43\n1157881.0\t36\n5647268.0\t33\n5113276.0\t32\n1737660.0\t31\n1761915.0\t31\n5450891.0\t29\n2755260.0\t29\n3621087.0\t28\n1894095.0\t27\n3009727.0\t27\n558968.0\t27\n266646.0\t26\n1905614.0\t26\n514645.0\t25\n1328552.0\t23\n2427644.0\t22\n623975.0\t22\n3129196.0\t22\n3646900.0\t21\n3779719.0\t21\n2525648.0\t21\n5578022.0\t21\n2122178.0\t20\n262090.0\t20\n5876800.0\t20\n4499960.0\t20\n2247933.0\t19\n5659537.0\t19\n4666938.0\t19\n2251502.0\t19\n2318497.0\t19\n4130161.0\t19\n1692045.0\t19\n4409064.0\t19\n4690524.0\t18\n5617291.0\t18\n1177508.0\t18\n2079895.0\t18\n3588171.0\t18\n5615753.0\t18\n3712857.0\t18\n4710685.0\t18\n1907457.0\t18\n236818.0\t18\n2298268.0\t18\n2568440.0\t17\n1690447.0\t17\n5493297.0\t17\n424238.0\t17\n2251410.0\t16\n4887758.0\t16\n732574.0\t16\n1987860.0\t16\n2983784.0\t16\n5123370.0\t16\n1222213.0\t16\n5476089.0\t16\n1191106.0\t16\n3345651.0\t16\n2367502.0\t16\n2618976.0\t16\n3515817.0\t16\n2117320.0\t16\n5267669.0\t16\n258177.0\t15\n3448216.0\t15\n4571295.0\t15\n2458745.0\t15\n4354867.0\t15\n2324278.0\t15\n1922207.0\t15\n416476.0\t15\n3262011.0\t15\n233096.0\t15\n4986766.0\t15\n511792.0\t15\n3543364.0\t15\n3958253.0\t15\n4299390.0\t15\n5588786.0\t14\n1331138.0\t14\n5186249.0\t14\n3269253.0\t14\n5583568.0\t14\n5648776.0\t14\n3341186.0\t14\n3970621.0\t14\n2240703.0\t14\n2014927.0\t14\n4753052.0\t14\n2452090.0\t14\n364143.0\t14\n3917688.0\t13\n4716284.0\t13\n271310.0\t13\n2885621.0\t13\n1617754.0\t13\n3325366.0\t13\n2905336.0\t13\n3564109.0\t13\n2688190.0\t13\n1651849.0\t13\n2993450.0\t13\n5291793.0\t13\n203423.0\t13\n599891.0\t13\n2223575.0\t13\n5207486.0\t13\n4977308.0\t13\n785397.0\t13\n5599644.0\t12\n3000753.0\t12\n1656808.0\t12\n1017904.0\t12\n2872888.0\t12\n660298.0\t12\n61386.0\t12\n358856.0\t12\n738601.0\t12\n2069572.0\t12\n519710.0\t12\n3767308.0\t12\n3263117.0\t12\n1487053.0\t12\n4386295.0\t12\n3469156.0\t12\n2341509.0\t12\n2862325.0\t12\n906433.0\t12\n3825729.0\t12\n1833059.0\t12\n3743470.0\t12\n1846278.0\t12\n1319701.0\t12\n4931987.0\t12\n3527814.0\t12\n3400681.0\t12\n3205774.0\t12\n883263.0\t12\n5862836.0\t12\n5793917.0\t12\n2538469.0\t12\n145843.0\t12\n1145445.0\t12\n3338589.0\t12\n1336210.0\t12\n2687664.0\t12\n4530914.0\t12\n907070.0\t12\n4912715.0\t12\n288793.0\t12\n4969341.0\t11\n2768778.0\t11\n2384300.0\t11\n3864083.0\t11\n5606781.0\t11\n4613047.0\t11\n5701096.0\t11\n1403026.0\t11\n1311336.0\t11\n5276279.0\t11\n5107017.0\t11\n2723736.0\t11\n3326416.0\t11\n3934117.0\t11\n862419.0\t11\n1126511.0\t11\n3048701.0\t11\n4381046.0\t11\n5420698.0\t11\n71976.0\t11\n5548572.0\t11\n1818546.0\t11\n2879533.0\t11\n2679106.0\t11\n4995155.0\t11\n2578567.0\t11\n10701.0\t11\n521712.0\t11\n5018176.0\t11\n101900.0\t11\n2237164.0\t11\n1343550.0\t11\n5123071.0\t11\n5728088.0\t11\n2164660.0\t11\n1582507.0\t11\n3234290.0\t11\n1666742.0\t11\n4947290.0\t11\n420835.0\t11\n32939.0\t11\n214821.0\t11\n2387379.0\t11\n3639193.0\t11\n3863638.0\t11\n2939132.0\t11\n2399549.0\t11\n4505995.0\t11\n1771371.0\t11\n5774263.0\t11\n2232742.0\t11\n3745022.0\t11\n641895.0\t11\n653546.0\t11\n2857965.0\t11\n292633.0\t11\n3049208.0\t10\n4870239.0\t10\n1997027.0\t10\n2693347.0\t10\n4492603.0\t10\n1596505.0\t10\n3185094.0\t10\n5553595.0\t10\n3373038.0\t10\n2125958.0\t10\n5344576.0\t10\n87944.0\t10\n4910818.0\t10\n992693.0\t10\n280783.0\t10\n4510469.0\t10\n4396221.0\t10\n2303294.0\t10\n1778669.0\t10\n5188879.0\t10\n516931.0\t10\n4371742.0\t10\n1522099.0\t10\n761731.0\t10\n4734419.0\t10\n3212017.0\t10\n5793730.0\t10\n4325398.0\t10\n3332974.0\t10\n3720968.0\t10\n1658787.0\t10\n3287894.0\t10\n2914936.0\t10\n1313459.0\t10\n668938.0\t10\n3440826.0\t10\n3711244.0\t10\n491253.0\t10\n3141940.0\t10\n4461188.0\t10\n2913135.0\t10\n3094440.0\t10\n3718242.0\t10\n692723.0\t10\n3476872.0\t10\n2400518.0\t10\n3449078.0\t10\n2313391.0\t10\n4102448.0\t10\n4868477.0\t10\n4975007.0\t10\n1223007.0\t10\n2990291.0\t10\n4917584.0\t10\n4028854.0\t10\n5236000.0\t10\n2657877.0\t10\n4957789.0\t10\n5533256.0\t10\n3178499.0\t10\n4755005.0\t10\n5845486.0\t10\n882751.0\t10\n1525240.0\t10\n5669246.0\t10\n4036574.0\t10\n3742080.0\t10\n67705.0\t10\n281369.0\t10\n4529539.0\t10\n1910376.0\t10\n2435387.0\t10\n5806922.0\t10\n766477.0\t10\n2999365.0\t10\n1242208.0\t10\n5247934.0\t10\n4766326.0\t10\n4547617.0\t10\n3107373.0\t10\n5509642.0\t10\n1914219.0\t10\n1357623.0\t9\n3773214.0\t9\n4515627.0\t9\n5187240.0\t9\n5237556.0\t9\n1064027.0\t9\n2516726.0\t9\n397131.0\t9\n463631.0\t9\n1760043.0\t9\n744530.0\t9\n1840281.0\t9\n1398387.0\t9\n5632006.0\t9\n4447881.0\t9\n1119592.0\t9\n323486.0\t9\n5553775.0\t9\n5538549.0\t9\n2049569.0\t9\n2909933.0\t9\n1494611.0\t9\n3275105.0\t9\n3773737.0\t9\n5301399.0\t9\n2077004.0\t9\n4998245.0\t9\n2965996.0\t9\n2611236.0\t9\n2798180.0\t9\n4641343.0\t9\n3397398.0\t9\n1688233.0\t9\n4724470.0\t9\n2054222.0\t9\n1029292.0\t9\n4115068.0\t9\n1101114.0\t9\n4892228.0\t9\n1437420.0\t9\n4876925.0\t9\n3229166.0\t9\n2093888.0\t9\n2101985.0\t9\n2415888.0\t9\n2204724.0\t9\n4091917.0\t9\n4196769.0\t9\n5230419.0\t9\n3068017.0\t9\n3744817.0\t9\n2702256.0\t9\n5613033.0\t9\n2110053.0\t9\n4195479.0\t9\n965440.0\t9\n900840.0\t9\n4912649.0\t9\n5882965.0\t9\n1676192.0\t9\n576484.0\t9\n468595.0\t9\n2778032.0\t9\n323813.0\t9\n5826778.0\t9\n4458027.0\t9\n2992767.0\t9\n3909178.0\t9\n1183308.0\t9\n100822.0\t9\n3693098.0\t9\n5055704.0\t9\n4791882.0\t9\n4876957.0\t9\n2853969.0\t9\n1429462.0\t9\n2931784.0\t9\n1429367.0\t9\n1692355.0\t9\n4104358.0\t9\n3084537.0\t9\n5096430.0\t9\n2537731.0\t9\n2266692.0\t9\n2065296.0\t9\n3238470.0\t9\n1375870.0\t9\n2326405.0\t9\n4641658.0\t9\n5691310.0\t9\n299111.0\t9\n5209549.0\t9\n4178678.0\t9\n2192354.0\t9\n4753504.0\t9\n4553214.0\t9\n898452.0\t9\n5569681.0\t9\n1829507.0\t9\n1443055.0\t9\n4083753.0\t9\n1142121.0\t9\n906321.0\t9\n859285.0\t9\n616572.0\t9\n3378528.0\t9\n590272.0\t9\n2025968.0\t9\n96659.0\t9\n2014776.0\t9\n3132514.0\t9\n71078.0\t9\n2972080.0\t9\n2138613.0\t9\n1268845.0\t9\n2225990.0\t9\n4846519.0\t9\n2886039.0\t9\n3069963.0\t9\n4672729.0\t9\n1426214.0\t9\n3824771.0\t8\n627224.0\t8\n4131749.0\t8\n3220392.0\t8\n2403194.0\t8\n3547032.0\t8\n2568427.0\t8\n4489564.0\t8\n3963300.0\t8\n3110031.0\t8\n1102601.0\t8\n1071349.0\t8\n2604923.0\t8\n2864264.0\t8\n5416820.0\t8\n3420909.0\t8\n2388875.0\t8\n1336263.0\t8\n2457357.0\t8\n4939880.0\t8\n1408728.0\t8\n5688638.0\t8\n3469229.0\t8\n5836454.0\t8\n414088.0\t8\n1141872.0\t8\n2825165.0\t8\n4131666.0\t8\n598146.0\t8\n5658177.0\t8\n4655758.0\t8\n1548959.0\t8\n5561438.0\t8\n3175088.0\t8\n4065378.0\t8\n4867334.0\t8\n5608103.0\t8\n5185782.0\t8\n1031865.0\t8\n5280798.0\t8\n850633.0\t8\n3708828.0\t8\n877802.0\t8\n2223606.0\t8\n1324989.0\t8\n1153184.0\t8\n4062541.0\t8\n468163.0\t8\n577581.0\t8\n953479.0\t8\n1727071.0\t8\n5515995.0\t8\n4355898.0\t8\n585827.0\t8\n4898292.0\t8\n1380557.0\t8\n4474460.0\t8\n1100074.0\t8\n675135.0\t8\n230678.0\t8\n681335.0\t8\n3010737.0\t8\n1673317.0\t8\n2411731.0\t8\n3895085.0\t8\n4954409.0\t8\n3512603.0\t8\n2647974.0\t8\n1462963.0\t8\n2769554.0\t8\n868067.0\t8\n3652728.0\t8\n3641251.0\t8\n4463482.0\t8\n232257.0\t8\n3790704.0\t8\n1090037.0\t8\n497025.0\t8\n1586405.0\t8\n633790.0\t8\n2159987.0\t8\n3826206.0\t8\n2267380.0\t8\n4273015.0\t8\n1768133.0\t8\n834985.0\t8\n3430002.0\t8\n3159602.0\t8\n483335.0\t8\n5027555.0\t8\n2634179.0\t8\n1778795.0\t8\n3431177.0\t8\n3296191.0\t8\n2778793.0\t8\n255874.0\t8\n5111650.0\t8\n3740000.0\t8\n5484288.0\t8\n3818087.0\t8\n1991622.0\t8\n2466776.0\t8\n3199568.0\t8\n2547861.0\t8\n5146114.0\t8\n4681961.0\t8\n5559658.0\t8\n3445781.0\t8\n2956776.0\t8\n2386773.0\t8\n5407056.0\t8\n3274066.0\t8\n1035798.0\t8\n3984234.0\t8\n3416435.0\t8\n696531.0\t8\n3320713.0\t8\n2493483.0\t8\n3407010.0\t8\n2787378.0\t8\n3864346.0\t8\n616948.0\t8\n3908915.0\t8\n2282656.0\t8\n3835909.0\t8\n907533.0\t8\n1987428.0\t8\n3974503.0\t8\n1747667.0\t8\n4855054.0\t8\n2749145.0\t8\n4668789.0\t8\n3349390.0\t8\n4835676.0\t8\n154230.0\t8\n4890517.0\t8\n216505.0\t8\n5002240.0\t8\n2024295.0\t8\n363950.0\t8\n3223135.0\t8\n5102376.0\t8\n1753251.0\t8\n3639842.0\t8\n3641841.0\t8\n1779697.0\t8\n4273409.0\t8\n2717583.0\t8\n3958842.0\t8\n4517570.0\t8\n663816.0\t8\n3111272.0\t8\n5048531.0\t8\n4326223.0\t8\n3047815.0\t8\n2601415.0\t8\n4833980.0\t8\n5369464.0\t8\n1400250.0\t8\n3195148.0\t8\n5236315.0\t8\n1211250.0\t8\n3810825.0\t8\n690363.0\t8\n953013.0\t8\n4264804.0\t8\n3247081.0\t8\n2936170.0\t8\n3283751.0\t8\n2371559.0\t8\n35644.0\t8\n245857.0\t8\n4595175.0\t8\n4758111.0\t8\n5103820.0\t8\n4326513.0\t8\n1918721.0\t8\n5155333.0\t8\n5508747.0\t8\n1373752.0\t8\n5267583.0\t8\n2577394.0\t8\n2621988.0\t8\n3982770.0\t8\n5861256.0\t8\n5492967.0\t8\n5881065.0\t8\n125009.0\t8\n3615425.0\t8\n3473500.0\t8\n49064.0\t8\n1330440.0\t8\n2957102.0\t8\n104073.0\t8\n5517090.0\t8\n5005550.0\t8\n341774.0\t8\n1569109.0\t8\n1713608.0\t8\n1921978.0\t8\n287397.0\t8\n3544637.0\t8\n4325400.0\t8\n4647480.0\t8\n1819010.0\t8\n5675837.0\t8\n1331902.0\t8\n226395.0\t8\n943917.0\t8\n1138964.0\t8\n910145.0\t8\n1097513.0\t7\n5502764.0\t7\n2075569.0\t7\n3449726.0\t7\n777635.0\t7\n2933189.0\t7\n2635600.0\t7\n1454959.0\t7\n1500905.0\t7\n2966697.0\t7\n4154386.0\t7\n2257896.0\t7\n684488.0\t7\n738688.0\t7\n3947276.0\t7\n3973663.0\t7\n2079737.0\t7\n2937125.0\t7\n2120828.0\t7\n1541059.0\t7\n999835.0\t7\n4151047.0\t7\n2814083.0\t7\n1801774.0\t7\n4026893.0\t7\n3807588.0\t7\n321035.0\t7\n5387489.0\t7\n1396221.0\t7\n510696.0\t7\n4996939.0\t7\n5077364.0\t7\n2134338.0\t7\n2050281.0\t7\n5823191.0\t7\n1522387.0\t7\n1375298.0\t7\n2384941.0\t7\n386465.0\t7\n2769980.0\t7\n4939741.0\t7\n3133469.0\t7\n727035.0\t7\n4160531.0\t7\n2534072.0\t7\n3077432.0\t7\n5768965.0\t7\n4862501.0\t7\n3799770.0\t7\n1136348.0\t7\n2260899.0\t7\n1948794.0\t7\n4127202.0\t7\n3078393.0\t7\n3408829.0\t7\n1576421.0\t7\n4200047.0\t7\n2452342.0\t7\n5721437.0\t7\n4548458.0\t7\n2486661.0\t7\n3627453.0\t7\n201252.0\t7\n649030.0\t7\n4041816.0\t7\n2379088.0\t7\n31853.0\t7\n3282610.0\t7\n5175479.0\t7\n5025126.0\t7\n3064018.0\t7\n4374552.0\t7\n5583884.0\t7\n5682478.0\t7\n182289.0\t7\n1543059.0\t7\n2574475.0\t7\n5564250.0\t7\n2188584.0\t7\n5095176.0\t7\n805325.0\t7\n5660690.0\t7\n1624755.0\t7\n1868596.0\t7\n1135206.0\t7\n2824783.0\t7\n1256692.0\t7\n2024012.0\t7\n109260.0\t7\n3476615.0\t7\n3114883.0\t7\n2496226.0\t7\n3510354.0\t7\n3634728.0\t7\n1555231.0\t7\n75652.0\t7\n5686620.0\t7\n2484155.0\t7\n4940508.0\t7\n1179570.0\t7\n4102621.0\t7\n4021236.0\t7\n4727555.0\t7\n317335.0\t7\n460335.0\t7\n2136838.0\t7\n106094.0\t7\n91470.0\t7\n4804448.0\t7\n5226825.0\t7\n4098130.0\t7\n4956530.0\t7\n1128509.0\t7\n2063022.0\t7\n2948718.0\t7\n27567.0\t7\n5150229.0\t7\n2622268.0\t7\n5538539.0\t7\n3098847.0\t7\n969178.0\t7\n54286.0\t7\n2321917.0\t7\n2411824.0\t7\n3871088.0\t7\n2218021.0\t7\n5289627.0\t7\n22603.0\t7\n5540516.0\t7\n4600033.0\t7\n157231.0\t7\n189429.0\t7\n4783402.0\t7\n656865.0\t7\n2272018.0\t7\n2226228.0\t7\n4724326.0\t7\n4042663.0\t7\n3136428.0\t7\n5688719.0\t7\n5783181.0\t7\n5802965.0\t7\n1680784.0\t7\n3625848.0\t7\n4909046.0\t7\n2819978.0\t7\n3531677.0\t7\n797571.0\t7\n3344735.0\t7\n4929188.0\t7\n2238859.0\t7\n5641482.0\t7\n4199166.0\t7\n2381940.0\t7\n2229893.0\t7\n799561.0\t7\n3545400.0\t7\n2411106.0\t7\n4831009.0\t7\n4414135.0\t7\n4575058.0\t7\n104735.0\t7\n506200.0\t7\n2848967.0\t7\n5873840.0\t7\n1889930.0\t7\n3138311.0\t7\n4632815.0\t7\n442955.0\t7\n4169671.0\t7\n2990729.0\t7\n4622064.0\t7\n2569348.0\t7\n2062974.0\t7\n3468260.0\t7\n5323083.0\t7\n4371495.0\t7\n396070.0\t7\n5621257.0\t7\n2454304.0\t7\n4793891.0\t7\n3358041.0\t7\n5038183.0\t7\n1721225.0\t7\n5377808.0\t7\n3479570.0\t7\n3381267.0\t7\n2632606.0\t7\n3657685.0\t7\n572985.0\t7\n4491876.0\t7\n932785.0\t7\n793182.0\t7\n5550738.0\t7\n4343654.0\t7\n5298296.0\t7\n5760700.0\t7\n3037932.0\t7\n4289187.0\t7\n11791.0\t7\n1641724.0\t7\n3677593.0\t7\n1702441.0\t7\n3642336.0\t7\n3807787.0\t7\n1563036.0\t7\n4092409.0\t7\n1368236.0\t7\n3014235.0\t7\n4469676.0\t7\n2357990.0\t7\n560199.0\t7\n1758408.0\t7\n5163356.0\t7\n4960417.0\t7\n4999926.0\t7\n741643.0\t7\n3903965.0\t7\n529978.0\t7\n4657319.0\t7\n5426590.0\t7\n1070714.0\t7\n2762653.0\t7\n5666136.0\t7\n3383823.0\t7\n43899.0\t7\n9209.0\t7\n1869439.0\t7\n4807736.0\t7\n4739143.0\t7\n4188.0\t7\n2576251.0\t7\n4326340.0\t7\n2635858.0\t7\n1259305.0\t7\n135754.0\t7\n1752334.0\t7\n630040.0\t7\n3571618.0\t7\n2972644.0\t7\n3618428.0\t7\n28407.0\t7\n431695.0\t7\n3321991.0\t7\n3857616.0\t7\n3771404.0\t7\n339555.0\t7\n2516780.0\t7\n321950.0\t7\n2779772.0\t7\n2776459.0\t7\n4018996.0\t7\n443916.0\t7\n1639095.0\t7\n5174937.0\t7\n1652701.0\t7\n3711850.0\t7\n3278636.0\t7\n4156305.0\t7\n2380040.0\t7\n298352.0\t7\n835012.0\t7\n1676280.0\t7\n4419965.0\t7\n3468240.0\t7\n2960188.0\t7\n4445836.0\t7\n353212.0\t7\n1307870.0\t7\n4858924.0\t7\n3186872.0\t7\n3261306.0\t7\n4397229.0\t7\n3933175.0\t7\n1248769.0\t7\n2238948.0\t7\n3688692.0\t7\n4758449.0\t7\n2773528.0\t7\n4263210.0\t7\n1012013.0\t7\n558813.0\t7\n911175.0\t7\n25422.0\t7\n3572532.0\t7\n2576001.0\t7\n4473354.0\t7\n5072220.0\t7\n2341959.0\t7\n2976558.0\t7\n3285358.0\t7\n1201473.0\t7\n1392799.0\t7\n64451.0\t7\n5732383.0\t7\n5060070.0\t7\n1817266.0\t7\n4805478.0\t7\n1444038.0\t7\n4988265.0\t7\n2368933.0\t7\n5214146.0\t7\n5060589.0\t7\n2334921.0\t7\n1843440.0\t7\n3361599.0\t7\n1806727.0\t7\n4413793.0\t7\n1425033.0\t7\n169499.0\t7\n4225953.0\t7\n4258219.0\t7\n5269173.0\t7\n4189633.0\t7\n1987436.0\t7\n768677.0\t7\n1953845.0\t7\n379001.0\t7\n2395301.0\t7\n4273714.0\t7\n2746138.0\t7\n4416482.0\t7\n5638767.0\t7\n964711.0\t7\n3076161.0\t7\n3542865.0\t7\n4905853.0\t7\n306129.0\t7\n3376376.0\t7\n1359214.0\t7\n1300620.0\t7\n5166274.0\t7\n3301483.0\t7\n1233298.0\t7\n4425392.0\t7\n2084481.0\t7\n1966134.0\t7\n5536597.0\t7\n1349098.0\t7\n1160271.0\t7\n440300.0\t7\n2560172.0\t7\n2306650.0\t7\n1425294.0\t7\n2173737.0\t7\n2966984.0\t7\n251928.0\t7\n1805270.0\t7\n5617331.0\t7\n5283605.0\t7\n2010061.0\t7\n4379883.0\t7\n2525249.0\t7\n5253435.0\t7\n2443170.0\t7\n2476836.0\t7\n2810598.0\t7\n189163.0\t7\n539350.0\t7\n104245.0\t7\n405497.0\t7\n1167045.0\t7\n5737898.0\t7\n501821.0\t7\n123608.0\t7\n\n\u003cfont color\u003dred\u003eResults are limited by 1000.\u003c/font\u003e"
      },
      "dateCreated": "Jun 8, 2018 1:38:20 PM",
      "dateStarted": "Jun 8, 2018 4:45:59 PM",
      "dateFinished": "Jun 8, 2018 5:13:48 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val parquetFileOfferTemp \u003d sqlContext.read.parquet(\"/data/sidana/purch_april_2018/*.parquet\")\nval offers \u003d parquetFileOfferTemp.select($\"offerId\",$\"userId\")\nval groupedOffers \u003d offers.groupBy($\"userId\").count.sort(desc(\"count\"))\nz.show(groupedOffers)",
      "authenticationInfo": {},
      "dateUpdated": "Jun 8, 2018 5:28:29 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1528457869277_-1947001431",
      "id": "20180608-133749_1635229109",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "userId\tcount\n2679106.0\t2029\n1600410.0\t1895\n2609559.0\t1801\n5207486.0\t1752\n1761915.0\t1675\n2755260.0\t1653\n366818.0\t1614\n5264033.0\t1585\n5354604.0\t1468\n371131.0\t1288\n2223575.0\t1227\n1388871.0\t1155\n1692045.0\t1125\n2708314.0\t1099\n5416820.0\t1055\n708264.0\t1045\n113949.0\t1040\n5139713.0\t1028\n5053568.0\t1002\n1987041.0\t996\n5744062.0\t986\n1780430.0\t980\n4876300.0\t970\n186622.0\t963\n2079895.0\t948\n5113276.0\t945\n3771404.0\t924\n3102001.0\t906\n4898292.0\t900\n4621783.0\t862\n4255122.0\t840\n5784608.0\t830\n3894507.0\t824\n2234110.0\t808\n1801709.0\t805\n2318497.0\t798\n4409064.0\t795\n966764.0\t795\n4383723.0\t787\n1336210.0\t782\n4022744.0\t779\n1352390.0\t774\n3778865.0\t772\n3531695.0\t762\n201247.0\t753\n1282489.0\t744\n4512845.0\t736\n5175479.0\t736\n2493483.0\t735\n4463482.0\t731\n3917688.0\t729\n356318.0\t728\n960646.0\t725\n1039640.0\t721\n2435387.0\t720\n1466985.0\t714\n1489680.0\t711\n641895.0\t709\n1752334.0\t702\n2454304.0\t699\n2788004.0\t698\n3084467.0\t689\n1758304.0\t688\n4499960.0\t680\n3448253.0\t677\n2122554.0\t677\n3386105.0\t676\n4936701.0\t675\n5846702.0\t670\n2122178.0\t670\n810398.0\t667\n994674.0\t666\n3073690.0\t665\n2786400.0\t664\n2560216.0\t662\n1162732.0\t659\n1559405.0\t656\n2618971.0\t655\n923529.0\t653\n784006.0\t652\n1135206.0\t651\n3718242.0\t647\n4654922.0\t639\n3113134.0\t634\n4102621.0\t633\n1314321.0\t631\n4357532.0\t630\n2056510.0\t629\n2195491.0\t629\n4118244.0\t628\n2157050.0\t625\n4425392.0\t622\n4613047.0\t616\n4998245.0\t616\n2872888.0\t612\n5569140.0\t611\n1767319.0\t611\n2773528.0\t609\n1791221.0\t606\n2834925.0\t602\n1871094.0\t600\n2702197.0\t589\n2231628.0\t589\n195524.0\t589\n5438685.0\t588\n2587722.0\t588\n5137033.0\t584\n1341634.0\t582\n4300348.0\t581\n4273131.0\t581\n3003164.0\t578\n4188682.0\t577\n3784214.0\t577\n181821.0\t572\n1733152.0\t571\n575232.0\t569\n3612548.0\t567\n1905614.0\t560\n1057764.0\t558\n5199558.0\t557\n4030385.0\t552\n5774263.0\t548\n5424852.0\t546\n690399.0\t544\n682765.0\t544\n2568440.0\t543\n243274.0\t542\n3132707.0\t540\n4478826.0\t538\n5607201.0\t538\n1417908.0\t536\n652109.0\t535\n1616343.0\t533\n1035412.0\t532\n408920.0\t532\n5372500.0\t531\n4803998.0\t529\n4326223.0\t529\n3904157.0\t528\n2972644.0\t528\n558968.0\t527\n3973663.0\t523\n5696213.0\t523\n5205208.0\t521\n3602904.0\t521\n4465375.0\t520\n5740073.0\t520\n2739564.0\t518\n4515947.0\t517\n1160995.0\t515\n4424008.0\t515\n3185114.0\t514\n3949169.0\t514\n3026603.0\t514\n3835860.0\t513\n900840.0\t513\n2772377.0\t512\n4074143.0\t511\n521712.0\t511\n3547032.0\t510\n1617754.0\t509\n3034742.0\t509\n4990475.0\t508\n5017734.0\t508\n4196769.0\t507\n687882.0\t507\n3527814.0\t506\n4225953.0\t505\n2630743.0\t505\n4867669.0\t505\n5029859.0\t505\n3567588.0\t505\n5336905.0\t503\n2366938.0\t503\n1795685.0\t502\n3887137.0\t501\n1154488.0\t500\n54758.0\t499\n1633368.0\t498\n5498650.0\t497\n2365574.0\t496\n3030592.0\t495\n3704743.0\t494\n3155169.0\t493\n3360821.0\t493\n4360818.0\t492\n4473286.0\t491\n1173563.0\t489\n813815.0\t489\n1695066.0\t485\n1641287.0\t485\n5513304.0\t485\n3094470.0\t483\n1607612.0\t483\n4548140.0\t482\n2742343.0\t480\n906433.0\t480\n5498992.0\t479\n1214872.0\t478\n3277275.0\t478\n5788750.0\t477\n2587284.0\t476\n2039064.0\t475\n1512534.0\t475\n3981376.0\t474\n5357327.0\t474\n4558584.0\t474\n5710212.0\t473\n1012013.0\t473\n4360367.0\t472\n3621087.0\t471\n2791142.0\t471\n784661.0\t470\n1513460.0\t468\n4177058.0\t468\n2991085.0\t467\n4266148.0\t466\n3614035.0\t466\n4469676.0\t466\n2828538.0\t466\n681216.0\t465\n2576298.0\t463\n4745700.0\t462\n967779.0\t461\n1859607.0\t461\n3470114.0\t461\n5520396.0\t461\n67705.0\t460\n3593704.0\t460\n4345156.0\t460\n824650.0\t460\n4273409.0\t460\n2890672.0\t458\n3075532.0\t458\n796678.0\t458\n1864611.0\t458\n1453778.0\t457\n953479.0\t457\n5609303.0\t457\n242539.0\t456\n3229166.0\t456\n4130092.0\t456\n2459341.0\t456\n3515817.0\t455\n3061236.0\t454\n1876990.0\t454\n335955.0\t452\n3639920.0\t451\n3613994.0\t451\n3338589.0\t450\n285988.0\t450\n5821316.0\t448\n236818.0\t448\n5840957.0\t448\n660298.0\t448\n5719613.0\t447\n656158.0\t447\n431319.0\t447\n1882837.0\t447\n1852838.0\t446\n1894095.0\t446\n3060675.0\t446\n2528906.0\t445\n2810598.0\t445\n416290.0\t444\n1189151.0\t443\n4706942.0\t442\n3201965.0\t442\n5176697.0\t442\n204506.0\t442\n2782416.0\t442\n5058132.0\t442\n5758541.0\t442\n4530914.0\t441\n792738.0\t440\n2281613.0\t440\n107899.0\t439\n4269808.0\t439\n516182.0\t439\n3185721.0\t438\n436465.0\t437\n2581093.0\t437\n1789106.0\t437\n2876490.0\t435\n4244090.0\t435\n2621988.0\t434\n2515424.0\t434\n2974906.0\t434\n1639095.0\t433\n486102.0\t433\n4177503.0\t432\n576159.0\t432\n2664560.0\t432\n4507433.0\t432\n1415404.0\t431\n1071349.0\t431\n2714877.0\t430\n353212.0\t430\n2116009.0\t428\n911700.0\t428\n1803505.0\t428\n1159092.0\t427\n5580693.0\t426\n1543595.0\t425\n1991545.0\t425\n2348014.0\t425\n2804925.0\t424\n5424930.0\t423\n3752275.0\t423\n4593007.0\t422\n4473354.0\t422\n665295.0\t422\n5708983.0\t421\n5688658.0\t421\n3794833.0\t421\n3874433.0\t420\n5511314.0\t420\n2094255.0\t420\n5045921.0\t419\n3306870.0\t419\n1749546.0\t419\n2543141.0\t418\n3206240.0\t418\n40546.0\t418\n3716200.0\t418\n4261866.0\t417\n4835356.0\t417\n5474111.0\t416\n1483461.0\t416\n778665.0\t416\n2006505.0\t415\n2990291.0\t415\n5341413.0\t415\n5064384.0\t415\n2930726.0\t414\n3637498.0\t414\n4372169.0\t414\n3469229.0\t413\n483335.0\t413\n2324278.0\t412\n4779319.0\t411\n984254.0\t411\n327234.0\t411\n5711068.0\t410\n834428.0\t410\n2831977.0\t410\n1755877.0\t410\n2019110.0\t410\n5772192.0\t409\n3773495.0\t409\n1062301.0\t408\n2057985.0\t408\n647610.0\t408\n5491232.0\t408\n1246958.0\t407\n3048701.0\t407\n3892714.0\t406\n3275811.0\t405\n3702631.0\t405\n2628357.0\t404\n4219193.0\t404\n5253766.0\t404\n1269216.0\t404\n85378.0\t404\n898803.0\t404\n4575775.0\t404\n5421121.0\t404\n3999032.0\t403\n1968426.0\t403\n1660979.0\t403\n2315667.0\t402\n5156820.0\t402\n1202910.0\t401\n4849157.0\t401\n1038447.0\t401\n2687457.0\t400\n2391950.0\t400\n380004.0\t400\n5775309.0\t399\n3485.0\t399\n3651892.0\t398\n5464642.0\t398\n5590520.0\t397\n3833373.0\t397\n36524.0\t397\n1960280.0\t396\n3186657.0\t396\n5111650.0\t395\n1396287.0\t395\n1635920.0\t395\n2866706.0\t395\n3638012.0\t395\n1831535.0\t394\n4516201.0\t394\n1049487.0\t394\n318459.0\t393\n3997990.0\t393\n2060618.0\t393\n5290971.0\t393\n2720660.0\t393\n2015553.0\t392\n157231.0\t392\n3061031.0\t392\n697864.0\t392\n5416897.0\t392\n4858233.0\t391\n5537058.0\t391\n1488159.0\t391\n1063888.0\t391\n3000753.0\t391\n3336241.0\t391\n2622268.0\t391\n2054222.0\t391\n2551609.0\t391\n4325398.0\t390\n5341041.0\t390\n5656119.0\t390\n2980303.0\t390\n3432371.0\t390\n2120828.0\t389\n287397.0\t389\n5025508.0\t388\n2914945.0\t388\n3687142.0\t388\n695838.0\t387\n1739069.0\t387\n2863556.0\t387\n4389062.0\t387\n2381364.0\t387\n77285.0\t386\n1748973.0\t386\n6906.0\t385\n4380174.0\t385\n3572534.0\t385\n2525648.0\t384\n1732013.0\t384\n2793869.0\t383\n3650321.0\t383\n3411537.0\t382\n5465703.0\t382\n3719532.0\t381\n2336440.0\t381\n4174775.0\t381\n5876941.0\t380\n2473068.0\t380\n1145445.0\t379\n1149837.0\t379\n3475584.0\t378\n685257.0\t378\n2326405.0\t378\n3764314.0\t378\n1452935.0\t378\n3190299.0\t377\n3934435.0\t376\n4326340.0\t376\n162142.0\t376\n3772328.0\t375\n1107531.0\t375\n2851494.0\t375\n3698701.0\t374\n4196474.0\t374\n4270881.0\t374\n4155551.0\t374\n4455279.0\t374\n681773.0\t374\n3178147.0\t373\n2938302.0\t373\n1756697.0\t373\n2011534.0\t372\n4233664.0\t372\n4922207.0\t372\n5149525.0\t372\n4901699.0\t372\n680171.0\t371\n3003813.0\t371\n4592245.0\t371\n5047970.0\t371\n4143840.0\t370\n1440790.0\t370\n728997.0\t370\n1851637.0\t370\n1588917.0\t370\n2959928.0\t369\n1868596.0\t369\n5034023.0\t369\n3480623.0\t368\n2509727.0\t368\n390166.0\t368\n2695829.0\t368\n3988908.0\t368\n5599647.0\t368\n5278862.0\t368\n1882863.0\t367\n4345212.0\t367\n3799417.0\t367\n2010277.0\t367\n5328828.0\t367\n2796904.0\t366\n1165006.0\t366\n3894904.0\t366\n4730382.0\t366\n1999949.0\t366\n3376349.0\t366\n3617767.0\t366\n1707875.0\t365\n2448562.0\t365\n377469.0\t365\n1534781.0\t364\n477337.0\t364\n1330436.0\t364\n1576768.0\t364\n1471026.0\t363\n56995.0\t363\n1177508.0\t363\n2312551.0\t363\n1824262.0\t362\n85022.0\t362\n5820107.0\t361\n5185878.0\t361\n732547.0\t361\n5409999.0\t361\n2469969.0\t361\n4269319.0\t361\n690363.0\t361\n5731222.0\t360\n5146417.0\t360\n2577892.0\t360\n3906984.0\t360\n1278149.0\t359\n5521214.0\t358\n951731.0\t358\n353979.0\t358\n1612489.0\t358\n2143702.0\t358\n3742319.0\t358\n4019975.0\t358\n3264072.0\t358\n1300825.0\t357\n616572.0\t357\n513240.0\t357\n379631.0\t357\n5562288.0\t357\n1848396.0\t356\n1128476.0\t356\n1680657.0\t356\n611272.0\t356\n1484174.0\t356\n2637032.0\t355\n4674743.0\t355\n3068707.0\t355\n31859.0\t355\n2180009.0\t354\n1983903.0\t354\n3439970.0\t354\n2827424.0\t354\n1890817.0\t353\n31267.0\t353\n2099496.0\t353\n2243264.0\t353\n5886226.0\t353\n1435634.0\t353\n3834679.0\t353\n5265404.0\t353\n254322.0\t353\n2232742.0\t352\n4305333.0\t352\n2807711.0\t352\n1570946.0\t351\n665434.0\t351\n527783.0\t351\n4260989.0\t351\n729507.0\t351\n2164257.0\t350\n507138.0\t350\n4960730.0\t350\n5747237.0\t350\n597575.0\t350\n3585005.0\t350\n4359926.0\t349\n5296772.0\t349\n5116137.0\t349\n3871170.0\t349\n1491457.0\t349\n206981.0\t349\n5395879.0\t348\n4865844.0\t348\n442955.0\t348\n133252.0\t348\n2579766.0\t348\n22143.0\t348\n4853806.0\t348\n1004040.0\t347\n4830976.0\t347\n1321460.0\t347\n213753.0\t347\n4580415.0\t347\n2497866.0\t346\n5434638.0\t346\n1850337.0\t346\n2104691.0\t346\n4503051.0\t345\n1319701.0\t345\n1106900.0\t345\n4721026.0\t345\n2757142.0\t345\n3063251.0\t345\n4272615.0\t344\n557123.0\t344\n4881396.0\t344\n466422.0\t344\n2595602.0\t344\n1112612.0\t344\n1957211.0\t343\n3912557.0\t343\n4816330.0\t343\n3622141.0\t343\n3027280.0\t343\n5440006.0\t343\n3653046.0\t343\n5340882.0\t342\n3740511.0\t342\n115348.0\t342\n519710.0\t342\n3004492.0\t341\n420835.0\t341\n56951.0\t341\n5325277.0\t340\n4135460.0\t340\n2207374.0\t340\n3433051.0\t340\n1929024.0\t340\n5030432.0\t340\n233096.0\t340\n603171.0\t339\n2268338.0\t339\n5588209.0\t339\n1950903.0\t339\n3228054.0\t339\n4401149.0\t339\n2648785.0\t339\n5023489.0\t338\n2963627.0\t338\n5326859.0\t338\n2790121.0\t338\n3915023.0\t338\n2167820.0\t338\n5299298.0\t338\n5190023.0\t338\n1598017.0\t337\n4066301.0\t337\n4182754.0\t337\n1072424.0\t337\n687902.0\t336\n4645168.0\t336\n784002.0\t336\n1915842.0\t336\n1201473.0\t336\n1952397.0\t336\n896911.0\t336\n2523063.0\t335\n5517753.0\t335\n620308.0\t335\n3782287.0\t335\n1258994.0\t335\n5249290.0\t334\n2541187.0\t334\n5163975.0\t334\n4789937.0\t334\n1403026.0\t334\n190666.0\t333\n5096430.0\t333\n1395091.0\t333\n3919058.0\t332\n776807.0\t332\n4649861.0\t332\n302439.0\t332\n4274485.0\t332\n427507.0\t332\n727921.0\t332\n1906609.0\t332\n409839.0\t331\n5297279.0\t331\n288764.0\t331\n2788742.0\t331\n2548154.0\t331\n4725120.0\t330\n1204230.0\t330\n4565245.0\t330\n3693098.0\t329\n2929334.0\t329\n5278990.0\t329\n4164023.0\t329\n1482747.0\t329\n3147206.0\t329\n4298522.0\t329\n581974.0\t328\n4386187.0\t328\n1065995.0\t328\n4032128.0\t328\n100996.0\t328\n1802926.0\t328\n4906206.0\t327\n5812678.0\t327\n633307.0\t327\n5431780.0\t326\n4885865.0\t326\n4639728.0\t326\n4505398.0\t326\n4270370.0\t326\n482443.0\t326\n2411106.0\t326\n3583971.0\t326\n4449493.0\t326\n617478.0\t326\n2908437.0\t325\n2563415.0\t325\n2230388.0\t325\n187756.0\t325\n1458035.0\t325\n161241.0\t325\n5639404.0\t325\n5290616.0\t325\n3528049.0\t325\n1905468.0\t324\n5558582.0\t324\n1987428.0\t324\n4718379.0\t324\n2759292.0\t324\n3100594.0\t324\n984089.0\t323\n362394.0\t323\n3978902.0\t323\n1243719.0\t323\n2589007.0\t323\n1337815.0\t323\n367856.0\t323\n4105458.0\t323\n3882814.0\t323\n4576344.0\t322\n5553613.0\t322\n4843987.0\t322\n5578022.0\t322\n2753622.0\t322\n2787879.0\t322\n1969980.0\t322\n5247564.0\t321\n942139.0\t321\n1309247.0\t321\n2070210.0\t321\n668806.0\t321\n2551823.0\t321\n4778578.0\t321\n5153471.0\t321\n4864730.0\t320\n92956.0\t320\n4597470.0\t320\n502179.0\t320\n2550405.0\t320\n2298479.0\t320\n512440.0\t320\n3062125.0\t320\n5395470.0\t319\n4546018.0\t319\n712758.0\t319\n4164128.0\t319\n170160.0\t319\n1891873.0\t319\n4397472.0\t319\n2054685.0\t319\n3224306.0\t319\n4573924.0\t319\n3919276.0\t319\n4565688.0\t319\n929151.0\t319\n2934054.0\t319\n3255214.0\t318\n4140330.0\t318\n1418958.0\t318\n5120245.0\t318\n1796354.0\t318\n4848128.0\t317\n4211603.0\t317\n505800.0\t317\n4662169.0\t317\n1731584.0\t317\n2190578.0\t317\n3554460.0\t317\n390200.0\t317\n3105970.0\t317\n1933678.0\t317\n2242086.0\t317\n4619132.0\t316\n4806445.0\t316\n1178984.0\t316\n3542997.0\t316\n3613766.0\t316\n1990915.0\t316\n908959.0\t316\n1886036.0\t316\n1993612.0\t316\n28860.0\t315\n5205230.0\t315\n1804246.0\t315\n3628970.0\t315\n1387507.0\t315\n3406511.0\t315\n5266555.0\t315\n1558754.0\t315\n2863608.0\t315\n5661912.0\t314\n5570555.0\t314\n71976.0\t314\n4020458.0\t314\n4402686.0\t313\n1891815.0\t313\n3247081.0\t313\n3176940.0\t313\n3448374.0\t313\n1902727.0\t313\n3705192.0\t313\n3373038.0\t312\n627779.0\t312\n275118.0\t312\n4838658.0\t312\n455615.0\t312\n4054952.0\t311\n4072442.0\t311\n5593063.0\t311\n4101271.0\t311\n5415.0\t311\n3829947.0\t311\n403447.0\t311\n471297.0\t311\n3524929.0\t311\n3833480.0\t311\n2470236.0\t310\n2736704.0\t310\n575273.0\t310\n3382921.0\t310\n371226.0\t310\n5184882.0\t310\n994518.0\t310\n878101.0\t310\n3340113.0\t310\n5282178.0\t310\n2244794.0\t309\n2666944.0\t309\n5455401.0\t309\n1304284.0\t309\n448658.0\t309\n1335676.0\t309\n334402.0\t308\n1528227.0\t308\n1248630.0\t308\n1618537.0\t308\n1143405.0\t308\n2626177.0\t308\n60347.0\t307\n3857276.0\t307\n1716105.0\t307\n542316.0\t307\n4968417.0\t307\n2112362.0\t307\n2366046.0\t307\n213578.0\t307\n331272.0\t307\n638853.0\t306\n5084427.0\t306\n3277514.0\t306\n1259320.0\t306\n288300.0\t306\n5807758.0\t306\n1347860.0\t306\n4025121.0\t306\n4681220.0\t305\n4936641.0\t305\n3662476.0\t305\n4147134.0\t305\n3040060.0\t305\n1744451.0\t304\n2746146.0\t304\n1666742.0\t304\n2567601.0\t304\n3463105.0\t304\n2503037.0\t304\n3160228.0\t304\n804235.0\t304\n3642336.0\t303\n2960150.0\t303\n2331146.0\t303\n4498967.0\t303\n961807.0\t303\n2197780.0\t303\n4350817.0\t303\n2994368.0\t303\n5106831.0\t303\n3686936.0\t302\n2043905.0\t302\n3347239.0\t302\n5209417.0\t302\n5275121.0\t302\n2468442.0\t302\n5375471.0\t302\n4180169.0\t302\n1851547.0\t301\n2186452.0\t301\n1575403.0\t301\n1059963.0\t301\n497025.0\t301\n3441703.0\t301\n3804899.0\t301\n5047381.0\t301\n4886682.0\t301\n1556047.0\t301\n3562262.0\t301\n3707210.0\t301\n5564250.0\t300\n4101900.0\t300\n50263.0\t300\n5653945.0\t300\n4247544.0\t300\n1699011.0\t299\n150875.0\t299\n4869806.0\t299\n3845943.0\t299\n2327307.0\t299\n2737226.0\t298\n4168049.0\t298\n2353600.0\t298\n4888473.0\t298\n714121.0\t298\n654506.0\t298\n5511190.0\t298\n1978942.0\t298\n579356.0\t298\n3220392.0\t298\n26103.0\t298\n2046619.0\t298\n4939922.0\t298\n2981367.0\t297\n2023542.0\t297\n1953163.0\t297\n4769458.0\t297\n5632006.0\t297\n496351.0\t297\n4616126.0\t297\n2338318.0\t297\n1473832.0\t296\n1182716.0\t296\n4086911.0\t296\n2004593.0\t296\n5136868.0\t296\n5817845.0\t296\n2910752.0\t296\n3900954.0\t296\n74253.0\t296\n2823284.0\t296\n4812453.0\t296\n4947290.0\t295\n3303338.0\t295\n1746782.0\t295\n5436575.0\t295\n2926738.0\t295\n5320057.0\t295\n3110613.0\t295\n2846944.0\t295\n591116.0\t295\n357053.0\t295\n5364642.0\t294\n1699474.0\t294\n4699263.0\t294\n3514518.0\t294\n359051.0\t294\n2613956.0\t294\n4868253.0\t294\n2300055.0\t294\n2587839.0\t293\n3434831.0\t293\n2104096.0\t293\n1888750.0\t293\n3331371.0\t293\n5253435.0\t293\n5715371.0\t293\n2484147.0\t293\n1688287.0\t293\n2058118.0\t293\n4218748.0\t293\n2526980.0\t293\n1689170.0\t292\n5791783.0\t292\n5280848.0\t292\n3631028.0\t292\n3361599.0\t292\n1455765.0\t292\n1522099.0\t292\n4031129.0\t292\n1833939.0\t291\n1434047.0\t291\n4239499.0\t291\n851646.0\t291\n\n\u003cfont color\u003dred\u003eResults are limited by 1000.\u003c/font\u003e"
      },
      "dateCreated": "Jun 8, 2018 1:37:49 PM",
      "dateStarted": "Jun 8, 2018 5:28:29 PM",
      "dateFinished": "Jun 8, 2018 6:01:12 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val inputfile \u003d sqlContext.read.parquet(\"/data/sidana/purch_april_2018/*.parquet\")\n\t\t\t\t\t\t\t    \nval userClicks \u003d inputfile.filter(\"wasClicked\").groupBy(\"userId\").count.withColumnRenamed(\"count\", \"numClicks\")\nval groupByCount \u003d userClicks.groupBy(\"numClicks\").count.sort(\"numClicks\")\nval header \u003d \"numClicks,count\"\nval fileWritten\u003dgroupByCount.rdd.map(_.mkString(\",\")).mapPartitionsWithIndex((i, iter) \u003d\u003e if (i\u003d\u003d0) (List(header).toIterator ++ iter) else iter)\nfileWritten.coalesce(1, false).saveAsTextFile(\"/data/sidana/april_2018_pandor/stats/clickVsCount\")\n\nval userOfferViews \u003d inputfile.groupBy(\"userId\",\"offerViewId\").count.withColumnRenamed(\"count\", \"numOfferImpressions\")\nval uniqeUsersOfferViews \u003d userOfferViews.groupBy(\"userId\").count.withColumnRenamed(\"count\", \"numImpressions\")\nval groupByCount \u003d uniqeUsersOfferViews.groupBy(\"numImpressions\").count.sort(\"numImpressions\")\nval header \u003d \"numImpressions,count\"\nval fileWritten\u003dgroupByCount.rdd.map(_.mkString(\",\")).mapPartitionsWithIndex((i, iter) \u003d\u003e if (i\u003d\u003d0) (List(header).toIterator ++ iter) else iter)\nfileWritten.coalesce(1, false).saveAsTextFile(\"/data/sidana/april_2018_pandor/stats/impressionsVsCount\")",
      "authenticationInfo": {},
      "dateUpdated": "Jul 25, 2018 10:04:04 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1528457917637_712074838",
      "id": "20180608-133837_364640132",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "inputfile: org.apache.spark.sql.DataFrame \u003d [source: string, offerId: string, pageViewId: string, offerViewId: string, utcDate: timestamp, keywords: array\u003cstring\u003e, wasClicked: boolean, offerViewCountPerPageView: bigint, clickCountPerPageView: bigint, userId: double, productLemmas: array\u003cstring\u003e, productFeatures: vector, url: string, pageLemmas: array\u003cstring\u003e, pageFeatures: vector]\nuserClicks: org.apache.spark.sql.DataFrame \u003d [userId: double, numClicks: bigint]\ngroupByCount: org.apache.spark.sql.DataFrame \u003d [numClicks: bigint, count: bigint]\nheader: String \u003d numClicks,count\nfileWritten: org.apache.spark.rdd.RDD[String] \u003d MapPartitionsRDD[27] at mapPartitionsWithIndex at \u003cconsole\u003e:35\nuserOfferViews: org.apache.spark.sql.DataFrame \u003d [userId: double, offerViewId: string, numOfferImpressions: bigint]\nuniqeUsersOfferViews: org.apache.spark.sql.DataFrame \u003d [userId: double, numImpressions: bigint]\ngroupByCount: org.apache.spark.sql.DataFrame \u003d [numImpressions: bigint, count: bigint]\nheader: String \u003d numImpressions,count\nfileWritten: org.apache.spark.rdd.RDD[String] \u003d MapPartitionsRDD[54] at mapPartitionsWithIndex at \u003cconsole\u003e:37\n"
      },
      "dateCreated": "Jun 8, 2018 1:38:37 PM",
      "dateStarted": "Jul 25, 2018 6:39:32 PM",
      "dateFinished": "Jul 25, 2018 7:27:37 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val inputfile \u003d sqlContext.read.parquet(\"/data/sidana/purch_april_2018/*.parquet\").select(\"wasClicked\",\"utcDate\",\"userId\")\nval clicks \u003d inputfile.filter(\"wasClicked\")\nval groupByWeek \u003d clicks.groupBy(weekofyear($\"utcdate\")).count\nz.show(groupByWeek)\n",
      "authenticationInfo": {},
      "dateUpdated": "Jul 25, 2018 11:04:19 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1532536772700_612651460",
      "id": "20180725-183932_675656620",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "weekofyear(utcdate)\tcount\n13\t8494\n14\t73119\n15\t73565\n16\t84841\n17\t83269\n18\t14223\n"
      },
      "dateCreated": "Jul 25, 2018 6:39:32 PM",
      "dateStarted": "Jul 25, 2018 11:04:19 PM",
      "dateFinished": "Jul 25, 2018 11:24:11 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val distinctUserWeek \u003d inputfile.select($\"userId\",weekofyear($\"utcDate\")).distinct\nval groupByWeek \u003d distinctUserWeek.groupBy(\"weekofyear(utcDate)\").count\nz.show(groupByWeek)",
      "authenticationInfo": {},
      "dateUpdated": "Jul 25, 2018 11:04:19 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1532552487394_349446730",
      "id": "20180725-230127_1301413168",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "weekofyear(utcDate)\tcount\n13\t181622\n14\t1392446\n15\t1323201\n16\t1476493\n17\t1431159\n18\t232559\n"
      },
      "dateCreated": "Jul 25, 2018 11:01:27 PM",
      "dateStarted": "Jul 25, 2018 11:04:21 PM",
      "dateFinished": "Jul 25, 2018 11:49:55 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val inputfile \u003d sqlContext.read.parquet(\"/data/sidana/purch_april_2018/*.parquet\").select(\"wasClicked\",\"offerId\")\nval clicks \u003d inputfile.filter(\"wasClicked\")\nval groupByOffer \u003d clicks.groupBy(\"offerId\").count.select($\"offerId\",$\"count\".as(\"numTimesClicked\")).sort(desc(\"numTimesClicked\"))\nval numTimesEachItemClicked \u003d groupByOffer.groupBy(\"numTimesClicked\").count.sort(asc(\"numTimesClicked\"))\nz.show(numTimesEachItemClicked)\n\n",
      "authenticationInfo": {},
      "dateUpdated": "Jul 26, 2018 4:30:28 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [
            {
              "name": "numTimesClicked",
              "index": 0.0,
              "aggr": "sum"
            }
          ],
          "values": [
            {
              "name": "count",
              "index": 1.0,
              "aggr": "sum"
            }
          ],
          "groups": [],
          "scatter": {
            "xAxis": {
              "name": "numTimesClicked",
              "index": 0.0,
              "aggr": "sum"
            },
            "yAxis": {
              "name": "count",
              "index": 1.0,
              "aggr": "sum"
            }
          }
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1532552659982_871951584",
      "id": "20180725-230419_499772060",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "numTimesClicked\tcount\n31\t33\n631\t1\n32\t22\n832\t1\n33\t25\n833\t1\n233\t3\n433\t1\n633\t1\n34\t19\n234\t2\n35\t24\n435\t2\n36\t27\n236\t2\n37\t18\n237\t1\n238\t3\n38\t20\n438\t1\n1238\t1\n439\t1\n39\t27\n239\t2\n40\t21\n240\t1\n41\t16\n641\t2\n42\t23\n242\t2\n842\t1\n43\t26\n1843\t1\n243\t2\n44\t16\n1444\t1\n1044\t1\n244\t1\n844\t1\n45\t18\n1645\t1\n245\t3\n46\t22\n246\t1\n47\t25\n1047\t1\n247\t1\n48\t17\n448\t1\n248\t2\n49\t12\n249\t1\n1849\t1\n50\t14\n250\t2\n1050\t1\n51\t12\n451\t1\n251\t1\n52\t20\n252\t2\n53\t9\n54\t13\n254\t3\n1254\t1\n454\t1\n55\t12\n256\t2\n56\t11\n456\t1\n1256\t1\n57\t13\n257\t2\n58\t15\n59\t15\n259\t3\n459\t3\n60\t11\n260\t3\n61\t19\n262\t2\n62\t6\n662\t1\n63\t9\n1263\t1\n263\t1\n264\t3\n64\t7\n464\t1\n1064\t1\n65\t6\n265\t1\n66\t11\n266\t1\n1266\t1\n1267\t1\n67\t10\n467\t1\n267\t1\n68\t8\n268\t1\n2668\t1\n69\t12\n269\t3\n469\t1\n70\t7\n270\t1\n671\t1\n71\t11\n471\t1\n72\t8\n272\t3\n472\t1\n673\t1\n73\t9\n273\t2\n274\t3\n74\t12\n474\t1\n674\t1\n675\t1\n75\t4\n275\t1\n76\t5\n676\t1\n276\t4\n476\t1\n77\t14\n677\t1\n78\t7\n1278\t1\n278\t2\n279\t1\n79\t5\n479\t1\n80\t9\n480\t1\n280\t2\n880\t1\n81\t9\n481\t1\n282\t2\n82\t10\n882\t1\n682\t1\n83\t9\n1283\t1\n84\t4\n85\t8\n285\t3\n86\t8\n287\t2\n87\t4\n88\t8\n2088\t1\n89\t9\n689\t1\n289\t1\n1290\t1\n90\t5\n91\t6\n291\t3\n492\t2\n92\t3\n292\t2\n93\t6\n293\t1\n693\t1\n294\t2\n94\t7\n494\t1\n295\t3\n95\t4\n895\t1\n96\t8\n496\t1\n97\t3\n2497\t1\n297\t1\n98\t6\n498\t1\n298\t3\n99\t5\n299\t1\n100\t6\n300\t3\n101\t6\n301\t1\n102\t8\n702\t1\n103\t8\n303\t3\n503\t1\n304\t1\n104\t5\n105\t5\n106\t2\n306\t2\n107\t5\n307\t2\n108\t5\n308\t2\n508\t1\n109\t5\n509\t1\n510\t1\n110\t7\n710\t1\n511\t1\n311\t2\n111\t5\n1511\t1\n112\t8\n312\t1\n113\t6\n313\t3\n714\t1\n114\t3\n514\t1\n1914\t1\n115\t5\n515\t1\n116\t2\n316\t1\n117\t6\n317\t4\n118\t5\n119\t1\n519\t2\n120\t4\n520\t1\n321\t1\n521\t1\n121\t3\n122\t2\n1122\t1\n123\t4\n323\t1\n2123\t1\n124\t9\n324\t1\n125\t1\n126\t6\n127\t6\n128\t2\n328\t2\n529\t1\n129\t4\n329\t1\n130\t2\n131\t4\n531\t2\n331\t1\n132\t3\n732\t1\n332\t1\n933\t1\n133\t3\n533\t2\n334\t1\n134\t3\n135\t4\n335\t1\n735\t1\n136\t5\n536\t2\n736\t1\n137\t4\n537\t1\n337\t1\n138\t2\n338\t2\n139\t9\n140\t4\n141\t5\n541\t1\n1141\t1\n941\t1\n142\t3\n542\t1\n143\t4\n543\t1\n344\t1\n144\t6\n544\t1\n145\t3\n1146\t1\n146\t1\n147\t1\n148\t5\n348\t1\n349\t2\n149\t2\n150\t7\n350\t1\n750\t1\n151\t1\n152\t4\n752\t1\n352\t1\n753\t2\n153\t2\n353\t1\n154\t5\n554\t1\n1154\t1\n155\t4\n356\t2\n156\t3\n357\t2\n557\t1\n157\t1\n158\t4\n159\t2\n359\t2\n160\t3\n561\t1\n963\t1\n163\t4\n2364\t1\n564\t1\n164\t5\n165\t1\n1766\t1\n166\t2\n367\t1\n167\t3\n168\t4\n368\t1\n768\t1\n169\t3\n369\t1\n170\t3\n570\t1\n1370\t1\n171\t5\n771\t1\n772\t1\n173\t3\n373\t1\n1374\t1\n174\t3\n374\t2\n974\t1\n175\t4\n176\t2\n177\t3\n378\t1\n178\t1\n179\t1\n180\t5\n580\t1\n380\t1\n181\t4\n381\t2\n182\t3\n582\t1\n183\t4\n184\t2\n584\t1\n384\t1\n1784\t1\n185\t1\n585\t1\n186\t3\n187\t4\n587\t1\n188\t2\n189\t2\n389\t1\n390\t1\n190\t3\n790\t1\n391\t1\n191\t1\n791\t1\n192\t2\n193\t4\n194\t2\n395\t1\n795\t1\n195\t1\n196\t2\n197\t4\n797\t1\n2598\t1\n198\t4\n398\t1\n199\t2\n999\t1\n400\t1\n200\t4\n1200\t1\n1\t1311\n201\t4\n601\t1\n2\t718\n202\t3\n3\t490\n203\t3\n403\t1\n4\t363\n604\t2\n204\t1\n5\t266\n2005\t1\n6\t221\n406\t1\n206\t3\n1006\t1\n806\t1\n7\t195\n207\t1\n807\t1\n8\t159\n608\t1\n208\t1\n9\t137\n409\t2\n609\t1\n10\t158\n410\t1\n210\t1\n11\t103\n811\t1\n12\t101\n412\t1\n812\t1\n1412\t1\n212\t2\n13\t70\n613\t1\n14\t98\n214\t2\n15\t86\n215\t1\n16\t62\n216\t3\n1016\t1\n17\t60\n417\t1\n217\t2\n617\t1\n18\t58\n218\t3\n19\t46\n1219\t1\n1419\t1\n20\t62\n220\t1\n21\t43\n221\t1\n421\t1\n22\t55\n1422\t1\n2222\t1\n222\t1\n23\t35\n823\t1\n24\t45\n224\t1\n624\t1\n25\t41\n225\t2\n26\t34\n226\t3\n626\t1\n27\t27\n227\t2\n1827\t1\n28\t34\n428\t1\n429\t2\n29\t26\n229\t2\n629\t1\n30\t32\n230\t2\n830\t1\n430\t1\n"
      },
      "dateCreated": "Jul 25, 2018 11:04:19 PM",
      "dateStarted": "Jul 26, 2018 11:25:07 AM",
      "dateFinished": "Jul 26, 2018 11:44:45 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "z.show(numTimesEachItemClicked.sort(asc(\"numTimesClicked\")))",
      "authenticationInfo": {},
      "dateUpdated": "Jul 26, 2018 1:58:30 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1532597107672_751372616",
      "id": "20180726-112507_2072618410",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "numTimesClicked\tcount\n1\t1311\n2\t718\n3\t490\n4\t363\n5\t266\n6\t221\n7\t195\n8\t159\n9\t137\n10\t158\n11\t103\n12\t101\n13\t70\n14\t98\n15\t86\n16\t62\n17\t60\n18\t58\n19\t46\n20\t62\n21\t43\n22\t55\n23\t35\n24\t45\n25\t41\n26\t34\n27\t27\n28\t34\n29\t26\n30\t32\n31\t33\n32\t22\n33\t25\n34\t19\n35\t24\n36\t27\n37\t18\n38\t20\n39\t27\n40\t21\n41\t16\n42\t23\n43\t26\n44\t16\n45\t18\n46\t22\n47\t25\n48\t17\n49\t12\n50\t14\n51\t12\n52\t20\n53\t9\n54\t13\n55\t12\n56\t11\n57\t13\n58\t15\n59\t15\n60\t11\n61\t19\n62\t6\n63\t9\n64\t7\n65\t6\n66\t11\n67\t10\n68\t8\n69\t12\n70\t7\n71\t11\n72\t8\n73\t9\n74\t12\n75\t4\n76\t5\n77\t14\n78\t7\n79\t5\n80\t9\n81\t9\n82\t10\n83\t9\n84\t4\n85\t8\n86\t8\n87\t4\n88\t8\n89\t9\n90\t5\n91\t6\n92\t3\n93\t6\n94\t7\n95\t4\n96\t8\n97\t3\n98\t6\n99\t5\n100\t6\n101\t6\n102\t8\n103\t8\n104\t5\n105\t5\n106\t2\n107\t5\n108\t5\n109\t5\n110\t7\n111\t5\n112\t8\n113\t6\n114\t3\n115\t5\n116\t2\n117\t6\n118\t5\n119\t1\n120\t4\n121\t3\n122\t2\n123\t4\n124\t9\n125\t1\n126\t6\n127\t6\n128\t2\n129\t4\n130\t2\n131\t4\n132\t3\n133\t3\n134\t3\n135\t4\n136\t5\n137\t4\n138\t2\n139\t9\n140\t4\n141\t5\n142\t3\n143\t4\n144\t6\n145\t3\n146\t1\n147\t1\n148\t5\n149\t2\n150\t7\n151\t1\n152\t4\n153\t2\n154\t5\n155\t4\n156\t3\n157\t1\n158\t4\n159\t2\n160\t3\n163\t4\n164\t5\n165\t1\n166\t2\n167\t3\n168\t4\n169\t3\n170\t3\n171\t5\n173\t3\n174\t3\n175\t4\n176\t2\n177\t3\n178\t1\n179\t1\n180\t5\n181\t4\n182\t3\n183\t4\n184\t2\n185\t1\n186\t3\n187\t4\n188\t2\n189\t2\n190\t3\n191\t1\n192\t2\n193\t4\n194\t2\n195\t1\n196\t2\n197\t4\n198\t4\n199\t2\n200\t4\n201\t4\n202\t3\n203\t3\n204\t1\n206\t3\n207\t1\n208\t1\n210\t1\n212\t2\n214\t2\n215\t1\n216\t3\n217\t2\n218\t3\n220\t1\n221\t1\n222\t1\n224\t1\n225\t2\n226\t3\n227\t2\n229\t2\n230\t2\n233\t3\n234\t2\n236\t2\n237\t1\n238\t3\n239\t2\n240\t1\n242\t2\n243\t2\n244\t1\n245\t3\n246\t1\n247\t1\n248\t2\n249\t1\n250\t2\n251\t1\n252\t2\n254\t3\n256\t2\n257\t2\n259\t3\n260\t3\n262\t2\n263\t1\n264\t3\n265\t1\n266\t1\n267\t1\n268\t1\n269\t3\n270\t1\n272\t3\n273\t2\n274\t3\n275\t1\n276\t4\n278\t2\n279\t1\n280\t2\n282\t2\n285\t3\n287\t2\n289\t1\n291\t3\n292\t2\n293\t1\n294\t2\n295\t3\n297\t1\n298\t3\n299\t1\n300\t3\n301\t1\n303\t3\n304\t1\n306\t2\n307\t2\n308\t2\n311\t2\n312\t1\n313\t3\n316\t1\n317\t4\n321\t1\n323\t1\n324\t1\n328\t2\n329\t1\n331\t1\n332\t1\n334\t1\n335\t1\n337\t1\n338\t2\n344\t1\n348\t1\n349\t2\n350\t1\n352\t1\n353\t1\n356\t2\n357\t2\n359\t2\n367\t1\n368\t1\n369\t1\n373\t1\n374\t2\n378\t1\n380\t1\n381\t2\n384\t1\n389\t1\n390\t1\n391\t1\n395\t1\n398\t1\n400\t1\n403\t1\n406\t1\n409\t2\n410\t1\n412\t1\n417\t1\n421\t1\n428\t1\n429\t2\n430\t1\n433\t1\n435\t2\n438\t1\n439\t1\n448\t1\n451\t1\n454\t1\n456\t1\n459\t3\n464\t1\n467\t1\n469\t1\n471\t1\n472\t1\n474\t1\n476\t1\n479\t1\n480\t1\n481\t1\n492\t2\n494\t1\n496\t1\n498\t1\n503\t1\n508\t1\n509\t1\n510\t1\n511\t1\n514\t1\n515\t1\n519\t2\n520\t1\n521\t1\n529\t1\n531\t2\n533\t2\n536\t2\n537\t1\n541\t1\n542\t1\n543\t1\n544\t1\n554\t1\n557\t1\n561\t1\n564\t1\n570\t1\n580\t1\n582\t1\n584\t1\n585\t1\n587\t1\n601\t1\n604\t2\n608\t1\n609\t1\n613\t1\n617\t1\n624\t1\n626\t1\n629\t1\n631\t1\n633\t1\n641\t2\n662\t1\n671\t1\n673\t1\n674\t1\n675\t1\n676\t1\n677\t1\n682\t1\n689\t1\n693\t1\n702\t1\n710\t1\n714\t1\n732\t1\n735\t1\n736\t1\n750\t1\n752\t1\n753\t2\n768\t1\n771\t1\n772\t1\n790\t1\n791\t1\n795\t1\n797\t1\n806\t1\n807\t1\n811\t1\n812\t1\n823\t1\n830\t1\n832\t1\n833\t1\n842\t1\n844\t1\n880\t1\n882\t1\n895\t1\n933\t1\n941\t1\n963\t1\n974\t1\n999\t1\n1006\t1\n1016\t1\n1044\t1\n1047\t1\n1050\t1\n1064\t1\n1122\t1\n1141\t1\n1146\t1\n1154\t1\n1200\t1\n1219\t1\n1238\t1\n1254\t1\n1256\t1\n1263\t1\n1266\t1\n1267\t1\n1278\t1\n1283\t1\n1290\t1\n1370\t1\n1374\t1\n1412\t1\n1419\t1\n1422\t1\n1444\t1\n1511\t1\n1645\t1\n1766\t1\n1784\t1\n1827\t1\n1843\t1\n1849\t1\n1914\t1\n2005\t1\n2088\t1\n2123\t1\n2222\t1\n2364\t1\n2497\t1\n2598\t1\n2668\t1\n"
      },
      "dateCreated": "Jul 26, 2018 11:25:07 AM",
      "dateStarted": "Jul 26, 2018 1:58:30 PM",
      "dateFinished": "Jul 26, 2018 2:18:48 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val file_write\u003d numTimesEachItemClicked.sort(asc(\"numTimesClicked\"))\nfile_write.rdd.coalesce(1,false).saveAsTextFile(\"/data/sidana/april_2018_pandor/stats/numTimesEachItemClicked\")",
      "authenticationInfo": {},
      "dateUpdated": "Jul 26, 2018 3:57:48 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1532606310067_1958149470",
      "id": "20180726-135830_1781595195",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "file_write: org.apache.spark.sql.DataFrame \u003d [numTimesClicked: bigint, count: bigint]\n"
      },
      "dateCreated": "Jul 26, 2018 1:58:30 PM",
      "dateStarted": "Jul 26, 2018 3:57:48 PM",
      "dateFinished": "Jul 26, 2018 4:18:09 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val inputfile \u003d sqlContext.read.parquet(\"/data/sidana/purch_april_2018/*.parquet\").select(\"wasClicked\",\"offerId\")\nval clicks \u003d inputfile.filter(\"wasClicked\")\nval groupByOffer \u003d clicks.groupBy(\"offerId\").count.select($\"offerId\",$\"count\".as(\"numTimesClicked\")).sort(desc(\"numTimesClicked\"))\ngroupByOffer.rdd.coalesce(1,false).saveAsTextFile(\"/data/sidana/april_2018_pandor/stats/groupByOffer\")\n",
      "authenticationInfo": {},
      "dateUpdated": "Jul 27, 2018 3:50:56 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1532613460203_-814928039",
      "id": "20180726-155740_603955771",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "inputfile: org.apache.spark.sql.DataFrame \u003d [wasClicked: boolean, offerId: string]\nclicks: org.apache.spark.sql.DataFrame \u003d [wasClicked: boolean, offerId: string]\ngroupByOffer: org.apache.spark.sql.DataFrame \u003d [offerId: string, numTimesClicked: bigint]\n"
      },
      "dateCreated": "Jul 26, 2018 3:57:40 PM",
      "dateStarted": "Jul 27, 2018 3:50:56 PM",
      "dateFinished": "Jul 27, 2018 4:11:16 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val inputfile \u003d sqlContext.read.parquet(\"/data/sidana/purch_april_2018/*.parquet\").select(\"offerId\")\n//val clicks \u003d inputfile.filter(\"wasClicked\")\nval groupByOffer \u003d inputfile.groupBy(\"offerId\").count.select($\"offerId\",$\"count\".as(\"numTimesShown\")).sort(desc(\"numTimesShown\"))\ngroupByOffer.rdd.coalesce(1,false).saveAsTextFile(\"/data/sidana/april_2018_pandor/stats/groupByOffer_Offer\")",
      "authenticationInfo": {},
      "dateUpdated": "Jul 27, 2018 6:29:42 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1532699456375_-351766150",
      "id": "20180727-155056_712848889",
      "result": {
        "code": "ERROR",
        "type": "TEXT",
        "msg": "inputfile: org.apache.spark.sql.DataFrame \u003d [offerId: string]\n\u003cconsole\u003e:27: error: not found: value inputFile\n         val groupByOffer \u003d inputFile.groupBy(\"offerId\").count.select($\"offerId\",$\"count\".as(\"numTimesShown\")).sort(desc(\"numTimesShown\"))\n                            ^\n"
      },
      "dateCreated": "Jul 27, 2018 3:50:56 PM",
      "dateStarted": "Jul 27, 2018 6:17:53 PM",
      "dateFinished": "Jul 27, 2018 6:18:22 PM",
      "status": "ERROR",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// new users per week\n\nval inputfile \u003d sqlContext.read.parquet(\"/data/sidana/purch_april_2018/*.parquet\").select(\"utcDate\",\"userId\")\nval distinctUserWeek \u003d inputfile.select($\"userId\",weekofyear($\"utcDate\")).distinct\nval minWeek \u003d distinctUserWeek.select(min(distinctUserWeek(\"weekofyear(utcdate)\"))).head().getInt(0)\nval maxWeek \u003d distinctUserWeek.select(max(distinctUserWeek(\"weekofyear(utcdate)\"))).head().getInt(0)\nval start \u003d minWeek+1\nimport org.apache.spark.sql._\n      for(a\u003c-start to maxWeek){\n          val previous \u003d a-1\n          val dfPrevious \u003d distinctUserWeek.filter(distinctUserWeek(\"weekofyear(utcdate)\")\u003d\u003d\u003dprevious)\n          val dfpresent \u003d distinctUserWeek.filter(distinctUserWeek(\"weekofyear(utcdate)\")\u003d\u003d\u003da)\n          val setDifference \u003d dfpresent.select(\"userId\").except(dfPrevious.select(\"userId\"))\n          println(setDifference.count)\n      }",
      "authenticationInfo": {},
      "dateUpdated": "Aug 2, 2018 12:05:13 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1533204041741_-2020887992",
      "id": "20180802-120041_1658676553",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "inputfile: org.apache.spark.sql.DataFrame \u003d [utcDate: timestamp, userId: double]\ndistinctUserWeek: org.apache.spark.sql.DataFrame \u003d [userId: double, weekofyear(utcDate): int]\nminWeek: Int \u003d 13\nmaxWeek: Int \u003d 18\nstart: Int \u003d 14\nimport org.apache.spark.sql._\n1387876\n1298355\n1447586\n1395424\n223344\n"
      },
      "dateCreated": "Aug 2, 2018 12:00:41 PM",
      "dateStarted": "Aug 2, 2018 12:05:14 PM",
      "dateFinished": "Aug 2, 2018 4:26:55 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "//returning users per week\n\nval inputfile \u003d sqlContext.read.parquet(\"/data/sidana/purch_april_2018/*.parquet\").select(\"utcDate\",\"userId\",\"wasClicked\")\nval clicks \u003d inputfile.filter(\"wasClicked\")\nval distinctUserWeek \u003d clicks.select($\"userId\",weekofyear($\"utcDate\")).distinct\nval minWeek \u003d distinctUserWeek.select(min(distinctUserWeek(\"weekofyear(utcdate)\"))).head().getInt(0)\nval maxWeek \u003d distinctUserWeek.select(max(distinctUserWeek(\"weekofyear(utcdate)\"))).head().getInt(0)\nval start \u003d minWeek+1\nimport org.apache.spark.sql._\n      for(a\u003c-start to maxWeek){\n          val previous \u003d a-1\n          val dfPrevious \u003d distinctUserWeek.filter(distinctUserWeek(\"weekofyear(utcdate)\")\u003d\u003d\u003dprevious)\n          val dfpresent \u003d distinctUserWeek.filter(distinctUserWeek(\"weekofyear(utcdate)\")\u003d\u003d\u003da)\n          val previousUsers \u003d dfPrevious.select(\"userId\")\n          val presentUsers \u003d dfpresent.select(\"userId\")\n          val innerJoin \u003d previousUsers.join(presentUsers,previousUsers(\"userId\")\u003d\u003d\u003dpresentUsers(\"userId\"))\n          println(innerJoin.count)\n      }",
      "authenticationInfo": {},
      "dateUpdated": "Aug 2, 2018 4:56:06 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1533204235784_-1411370758",
      "id": "20180802-120355_1382102428",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "inputfile: org.apache.spark.sql.DataFrame \u003d [utcDate: timestamp, userId: double, wasClicked: boolean]\nclicks: org.apache.spark.sql.DataFrame \u003d [utcDate: timestamp, userId: double, wasClicked: boolean]\ndistinctUserWeek: org.apache.spark.sql.DataFrame \u003d [userId: double, weekofyear(utcDate): int]\nminWeek: Int \u003d 13\nmaxWeek: Int \u003d 18\nstart: Int \u003d 14\nimport org.apache.spark.sql._\n99\n592\n647\n774\n215\n"
      },
      "dateCreated": "Aug 2, 2018 12:03:55 PM",
      "dateStarted": "Aug 2, 2018 4:56:06 PM",
      "dateFinished": "Aug 2, 2018 8:57:23 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "//anonymized data stats\n\nval inputfile \u003d sqlContext.read\n\t\t\t\t\t\t\t.format(\"com.databricks.spark.csv\")\n\t\t\t\t\t\t\t.option(\"header\", \"true\") // Use first line of all files as header\n\t\t\t\t\t\t\t.option(\"inferSchema\", \"true\") // Automatically infer data types\n\t\t\t\t\t\t\t.option(\"delimiter\", \",\")\n\t\t\t\t\t\t\t.load(\"/data/sidana/april_2018_pandor/data/short_version/anonymized/train.csv\")\n\t\t\t\t\t\t\t\nval unique_users_count \u003d inputfile.select(\"userId\").distinct.count\n\nval unique_offers_count \u003d inputfile.select(\"offerId\").distinct.count\n\nval fullfile \u003d sqlContext.read\n\t\t\t\t\t\t\t.format(\"com.databricks.spark.csv\")\n\t\t\t\t\t\t\t.option(\"header\", \"true\") // Use first line of all files as header\n\t\t\t\t\t\t\t.option(\"inferSchema\", \"true\") // Automatically infer data types\n\t\t\t\t\t\t\t.option(\"delimiter\", \",\")\n\t\t\t\t\t\t\t.load(\"/data/sidana/april_2018_pandor/data/short_version/anonymized/full.csv\")\n\nval full_users_count \u003d fullfile.select(\"userId\").distinct.count\n\nval full_offers_count \u003d fullfile.select(\"offerId\").distinct.count\n\t\t\t\t\t\t\t\n\n\n",
      "authenticationInfo": {},
      "dateUpdated": "Sep 11, 2018 10:52:42 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1536655227064_-442486563",
      "id": "20180911-104027_1625649420",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "inputfile: org.apache.spark.sql.DataFrame \u003d [userId: string, offerId: int, rating: int, timestamp: int]\nunique_users_count: Long \u003d 177366\nunique_offers_count: Long \u003d 9077\nfullfile: org.apache.spark.sql.DataFrame \u003d [userId: string, offerId: int, rating: int, timestamp: int]\nfull_users_count: Long \u003d 177366\nfull_offers_count: Long \u003d 9077\n"
      },
      "dateCreated": "Sep 11, 2018 10:40:27 AM",
      "dateStarted": "Sep 11, 2018 10:52:43 AM",
      "dateFinished": "Sep 11, 2018 11:09:41 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val inputfile \u003d sqlContext.read\n\t\t\t\t\t\t\t.format(\"com.databricks.spark.csv\")\n\t\t\t\t\t\t\t.option(\"header\", \"true\") // Use first line of all files as header\n\t\t\t\t\t\t\t.option(\"inferSchema\", \"true\") // Automatically infer data types\n\t\t\t\t\t\t\t.option(\"delimiter\", \",\")\n\t\t\t\t\t\t\t.load(\"/data/sidana/april_2018_pandor/data/short_version/anonymized/test.csv\")\n\t\t\t\t\t\t\t\nval unique_users_count \u003d inputfile.select(\"userId\").distinct.count\n\nval unique_offers_count \u003d inputfile.select(\"offerId\").distinct.count",
      "authenticationInfo": {},
      "dateUpdated": "Sep 11, 2018 5:08:18 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1536678475325_666914506",
      "id": "20180911-170755_952504549",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "inputfile: org.apache.spark.sql.DataFrame \u003d [userId: string, offerId: int, rating: int, timestamp: int]\nunique_users_count: Long \u003d 10066\nunique_offers_count: Long \u003d 4523\n"
      },
      "dateCreated": "Sep 11, 2018 5:07:55 PM",
      "dateStarted": "Sep 11, 2018 5:08:19 PM",
      "dateFinished": "Sep 11, 2018 5:19:21 PM",
      "status": "ABORT",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val inputfile \u003d sqlContext.read\n\t\t\t\t\t\t\t.format(\"com.databricks.spark.csv\")\n\t\t\t\t\t\t\t.option(\"header\", \"true\") // Use first line of all files as header\n\t\t\t\t\t\t\t.option(\"inferSchema\", \"true\") // Automatically infer data types\n\t\t\t\t\t\t\t.option(\"delimiter\", \"\\t\")\n\t\t\t\t\t\t\t.load(\"/data/sidana/purch/diversity/data\").withColumn(\"utcdate\",unix_timestamp($\"utcdate\",\"yyyy-MM-dd HH:mm:ss\").cast(\"timestamp\")).withColumnRenamed(\"cast(unixtimestamp(utcdate,yyyy-MM-dd HH:mm:ss) as timestamp)\",\"utcdate\")\nval distinctUserWeek \u003d inputfile.select($\"userId\",weekofyear($\"utcDate\")).distinct\nval minWeek \u003d distinctUserWeek.select(min(distinctUserWeek(\"weekofyear(utcdate)\"))).head().getInt(0)\nval maxWeek \u003d distinctUserWeek.select(max(distinctUserWeek(\"weekofyear(utcdate)\"))).head().getInt(0)\nval start \u003d minWeek+1\nimport org.apache.spark.sql._\n      for(a\u003c-start to maxWeek){\n          val previous \u003d a-1\n          val dfPrevious \u003d distinctUserWeek.filter(distinctUserWeek(\"weekofyear(utcdate)\")\u003d\u003d\u003dprevious)\n          val dfpresent \u003d distinctUserWeek.filter(distinctUserWeek(\"weekofyear(utcdate)\")\u003d\u003d\u003da)\n          val setDifference \u003d dfpresent.select(\"userId\").except(dfPrevious.select(\"userId\"))\n          println(setDifference.count)\n      }",
      "dateUpdated": "Jul 27, 2018 7:14:43 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1532708974294_-2114682395",
      "id": "20180727-182934_1521484559",
      "dateCreated": "Jul 27, 2018 6:29:34 PM",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "purchBaselinesVer3: DataStatsFull",
  "id": "2DF8D6NWU",
  "angularObjects": {
    "2BJGSXM37": [],
    "2BGHSKCA7": [],
    "2BHKKP27G": [],
    "2BGVG5JP4": [],
    "2BFMBPKAB": [],
    "2BF969NNB": [],
    "2BJAQG5W4": [],
    "2BJHJDBK6": [],
    "2BHKAE8WK": [],
    "2BG8QQJNC": [],
    "2BJ7KKX85": [],
    "2BH9AVVKH": [],
    "2BJ6HN5AY": [],
    "2BFEDXCTE": [],
    "2BJ5FCP57": [],
    "2BJ8AEWCT": [],
    "2BFXEV5XZ": [],
    "2BG77RV7M": []
  },
  "config": {
    "looknfeel": "default"
  },
  "info": {}
}